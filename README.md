
# 

<table>
  <tr>
    <td><img src="./src/images/logo.svg" width="100" height="100" alt="logo"></td>
    <td><a href="https://git.io/typing-svg"><img src="https://readme-typing-svg.herokuapp.com?font=Fira+Code&weight=100&size=30&pause=1000&center=true&vCenter=true&multiline=true&repeat=false&random=false&width=950&lines=NaRuTagAI" alt="Typing SVG" /></a></td>
  </tr>
</table>

---

NaRuTagAI — проект с открытым исходных кодом, позволяющий автоматизировать присваивание и генерацию иерархических тегов для видео с помощьюю 
мультимодальной системы искусственного интеллекта. Мы используем визуальную, звуковую и текстовую модальности для 
рекомендации наиболее подходящих тегов. Инструмент окажется полезным как для серьезных штатных 
задач по обработке крупных наборов данных, так и для повседневных пользователських задач.

Проект включает в себя реляционную базу данных, внешний API, он открыт из веб-пространства, а также 
вы можете запускать его на локальной машине или в облаке.
---

> Каждый репозиторий на GitHub — это не просто код, это отражение чьего-то видения,
> идеи и стремления к совершенству. Проект на GitHub — это живой организм,
> который эволюционирует, учится и растет.

---

- [Структура репозитория](#структура-репозитория)
- [Необходимые требования](#требования)
- [Установка и настройка](#установка-и-настройка)
  - [Установка виртуальной среды и зависимостей](#1-установка-виртуальной-среды-и-зависимостей)
    - [Linux server](#linuxmacos)
    - [Windows server](#windows)
  - [Запуск тестов](#2-запуск-тестов)
    - [Linux server](#linuxmacos-1)
    - [Windows server](#windows-1)
  - [Подготовка набора данных](#подготовка-набора-данных)
    - [Свой набор данных](#вариант-1-загрузите-и-подготовьте-свой-набор-данных-из-rutube)
    - [Свои извлеченные future](#вариант-2-использование-собственных-предварительно-извлеченных-кадров)
    - [Автоматический](#вариант-3-использование-готового-пайплайна)
  - [Классификация по бегу](#классификация-по-бегу)
  - [Планы на будушее](#планируемые-функции)




 ## Структура репозитория

 **server**

```
    .
    ├── logs # - папка храенения логов
    |   ├── setup #
    |   |   ├── *.log #
    |   └── app.log #
    ├── setup - кастомный установщик среды
    |   ├── check_local_modules.py - проверка локальных модулей
    |   ├── debug_info.py - вывод информации
    |   ├── setup_common.py
    |   ├── setup_windows.py - установочное меню
    |   └── validate_requirements.py - валидация модулей
    ├── src
    |   ├── database
    |   |   ├── models.py - модели
    |   |   └── my_connector.py - класс для подключения к базе данных
    |   ├── repository - репозитории
    |   |   ├── image_repository.py
    |   |   └── ...
    |   ├── service - сервисы
    |   |   ├── image_services.py
    |   |   └── ...
    |   ├── utils
    |   |   ├── custom_logging.py - кастомный лог
    |   |   ├── exam_services.py - проверка на дубликаты
    |   |   ├── hashing.py - хеширование паролей
    |   |   ├── return_url_object.py - скрипт для формирования ссылок на изображения
    |   |   └── write_file_into_server.py - запись файлов на сервер
    |   └── validator
    |   |   └── validate.py - валидация моделей
    ├── venv - виртуальная среда
    ├── .env - переменные среды
    ├── .gitignore
    ├── clear_setup_log - очистка логов
    ├── config.py - скрипт для работы с переменными средами
    ├── create_sql.py - скрипт для авто создания и заполнения базы данных
    ├── logging.yaml - конфигурационный файл для лога
    ├── main.bat - запуск сервера на windows
    ├── main.py - основной исполняемый файл
    ├── main.sh - запуск сервера на linux
    ├── requirements.txt
    ├── setup.bat - установка среды на windows
    ├── setup.log # - файл лога
    ├── setup.sh - установка среды на linux
    ├── test_main.bat - тесты на windows
    ├── test_main.py
    └── test_main.sh - тесты на linux
```





  ## Требования
- Python 3.8+ (установлен на сервере)
- `pm2` (для управления процессами сервера на Linux/MacOS)





 ## Установка и настройка

### 1. Установка виртуальной среды и зависимостей

#### Linux/MacOS

1. Клонируйте репозиторий на сервер:
    ```bash
    git clone https://github.com/username/repo.git
    cd repo
    ```

2. Запустите скрипт для установки виртуальной среды и всех необходимых зависимостей:
    ```bash
    bash setup.sh
    ```

#### Windows

1. Клонируйте репозиторий на сервер:
    ```bash
    git clone https://github.com/username/repo.git
    cd repo
    ```

2. Запустите скрипт для установки виртуальной среды и всех необходимых зависимостей:
    ```cmd
    setup.bat
    ```





### 2. Запуск тестов

#### Linux/MacOS

Для запуска автоматической проверки тестов с использованием `pytest`, выполните:
```bash
bash test_main.sh
   ```

#### Windows

Для запуска автоматической проверки тестов с использованием `pytest`, выполните:
```bash
bash test_main.sh
   ```





## Подготовка набора данных

### Вариант 1: Загрузите и подготовьте свой набор данных из Rutube

Если вы хотите скачать видео с Rutube и извлечь кадры, выполните следующие действия:

1. **Заполните свои учетные данные и настройки** в файле `config.yaml`:
- **`DataInstaller`:** Укажите каталог, в который вы хотите сохранить загруженные видео.
- **`FrameExtractor`:** Установите частоту извлечения кадров (вы можете выбрать извлечение кадров каждую секунду, минуту или час), измените размеры и каталог, в котором будут сохраняться извлеченные кадры.

1. Загрузите видео и извлеките кадры:
Перед запуском процесса загрузки видео вам необходимо установить пакет `yt-dlp`. Этот инструмент необходим для загрузки видео с Rutube.
You can install `yt-dlp` via pip:

```bash
pip install yt-dlp
```

Дополнительную информацию о `yt-dlp` можно найти на [официальной странице PyPI](https://pypi.org/project/yt-dlp/).

---

Затем **запустите скрипт**, чтобы загрузить видео и извлечь кадры:

```bash
python3 run.py --url_path <your_path_to_file_with_urls> --save_video <True or False>
```
- Файл, указанный `<your_path_to_file_with_urls>`, должен содержать URL-адреса видео Rutube, каждый на новой строке.
- Видео и кадры будут сохранены в соответствии с настройками в файле `config.yaml`.


